# reviews-affinity-clustering-llm
Сквозной пайплайн анализа отзывов: пересечение аудиторий брендов (affinity), тематическая кластеризация текстов и интерактивное сравнение брендов по структуре обсуждений. Интерпретация тем автоматизирована локальной LLM (Ollama).

## Что внутри (результаты)
- affinity-таблица пересечений аудитории брендов
- темы/кластеры отзывов + доли тем по каждому бренду
- интерактивный дашборд/виджет для сравнения тематических профилей

## Структура проекта
- `notebooks/step1_parser_yk.ipynb` — сбор первичных данных (опционально)
- `notebooks/step2_affinity_analysis.ipynb` — affinity-анализ пересечение аудитории  
- `notebooks/step3_clustering_llm.ipynb` — кластеризация предложений и LLM-интерпретация: эмбеддинги, KMeans, описания тем и профилей брендов, интерактивный просмотр

## Данные
Используются публичные отзывы из открытого источника. Данные обрабатывались в агрегированном виде; персональные данные и идентификаторы пользователей не публикуются.

## Технологии
Python (Selenium, pandas, NumPy, scikit-learn (KMeans), sentence-transformers/embeddings, Plotly + ipywidgets; локальная LLM (Ollama))

## Как запустить локально
### 1) Установить зависимости
```bash
pip install -r requirements.txt
```
### 2) (Опционально) Установить Ollama и скачать модель (например, gemma3:4b)

### 3) Запустить ноутбуки по порядку
1) step1_parser_yk.ipynb (опционально, если нет готовых данных)
2) step2_affinity_analysis.ipynb
3) step3_clustering_llm.ipynb

## Ограничения
- качество тем зависит от выбранного K и модели эмбеддингов
- отзывы могут быть смещены (активнее пишут очень довольные/очень недовольные)
